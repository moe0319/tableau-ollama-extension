<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>超シンプルなTableauテスト</title>
    <script src="https://cdn.jsdelivr.net/npm/@tableau/extensions-api/lib/tableau.extensions.1.latest.min.js"></script>
</head>
<body>
    <h1>Tableau API テスト</h1>
    <div id="status">ステータス: 未初期化</div>
    <button id="init-button">初期化</button>
    <div id="result">結果がここに表示されます</div>

    <script>
        document.getElementById('init-button').addEventListener('click', function() {
            const statusDiv = document.getElementById('status');
            const resultDiv = document.getElementById('result');
            
            statusDiv.textContent = 'ステータス: 初期化試行中...';
            
            // Tableau オブジェクトが存在するかチェック
            if (typeof tableau === 'undefined') {
                statusDiv.textContent = 'ステータス: エラー - tableauオブジェクトが見つかりません';
                return;
            }
            
            // Extensions APIが存在するかチェック
            if (!tableau.extensions) {
                statusDiv.textContent = 'ステータス: エラー - tableau.extensionsが見つかりません';
                return;
            }
            
            // 初期化実行
            tableau.extensions.initializeAsync().then(function() {
                statusDiv.textContent = 'ステータス: 初期化成功!';
                
                // ダッシュボード情報を取得
                const dashboard = tableau.extensions.dashboardContent.dashboard;
                const worksheets = dashboard.worksheets;
                
                resultDiv.innerHTML = `
                    <p>ダッシュボード名: ${dashboard.name}</p>
                    <p>ワークシート数: ${worksheets.length}</p>
                    <ul>
                        ${worksheets.map(sheet => `<li>${sheet.name}</li>`).join('')}
                    </ul>
                `;
            }).catch(function(err) {
                statusDiv.textContent = 'ステータス: 初期化エラー - ' + err.message;
            });
        });
    </script>
</body>
</html>
