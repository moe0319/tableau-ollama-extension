tableau.extensions.initializeAsync().then(async function () {
    console.log('Tableau extension initialized');
    
    dashboard = tableau.extensions.dashboardContent.dashboard;
    sheets = dashboard.worksheets;
    
    console.log('Dashboard:', dashboard.name);
    console.log('Number of sheets:', sheets.length);
    console.log('Sheet names:', sheets.map(s => s.name));
    
    if (sheets.length > 0) {
        populateSheetSelector();
        await updateSelectedSheet();
        await fetchFiltersInfo();
        await refreshDataPreview();
    } else {
        showError('このダッシュボードにはワークシートがありません');
    }
    
    setupEventListeners();
    testOllamaConnection();
}).catch(function (err) {
    console.error('初期化エラー:', err);
    showError('Tableau拡張機能の初期化に失敗しました: ' + err);
});
